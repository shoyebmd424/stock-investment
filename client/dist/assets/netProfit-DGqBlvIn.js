import{r as I,j as e,u as M,g as m}from"./index-BzgxH7_M.js";import{B as R}from"./index-DxjXa1Bi.js";import{S as C}from"./index-DQlLYHdx.js";import{a as P,c as w}from"./dateTimeFormater-D7Rvvgct.js";import{c as b}from"./calculateIrrSingleInvestment-Dz4nqlKD.js";import{n as D,a as T}from"./investorGrossTotal-D-hXK5B4.js";const O=({deal:i,sector:s,currentValuation:o,userId:r})=>{const[p,a]=I.useState(0),[u,t]=I.useState(0),[j,S]=I.useState(0);return I.useEffect(()=>{(async()=>{const f=(await P(r)).reduce((x,h)=>{var c;const d=(c=h==null?void 0:h.investors)==null?void 0:c.find(l=>l.investerId===r);return x+parseInt((d==null?void 0:d.amount)||0,10)},0);S(f)})()},[r]),I.useEffect(()=>{i&&o&&(async()=>{var f;const n=(f=i==null?void 0:i.investors)==null?void 0:f.find(x=>x.investerId===r);if(n){const x=parseFloat((n==null?void 0:n.amount)||0)+parseFloat((n==null?void 0:n.fees)||0),h=parseFloat((n==null?void 0:n.carried)||0),d=parseFloat((n==null?void 0:n.shareholding)||0),c=await D(x,d,o,i.currency,h/100),l=await T(x,d,o,i.currency,h/100);a(c.toFixed(2)),t(l)}})()},[o,r,i,j]),e.jsxs(e.Fragment,{children:[e.jsx("td",{children:p}),e.jsx("td",{children:s}),e.jsx("td",{children:u})]})},G=(i,s)=>{try{let o=0;const r=[];return i.forEach(a=>{var u;(u=a==null?void 0:a.deals)==null||u.forEach(t=>{var S;o+=parseInt((t==null?void 0:t.currentValue)||0);const j=(S=t==null?void 0:t.investors)==null?void 0:S.find(N=>(N==null?void 0:N.investerId)===s);j&&r.push([parseInt((j==null?void 0:j.amount)||0),new Date(t==null?void 0:t.investedDate)])})}),{totalCurrentValue:o,currentDate:new Date,investments:r}}catch(o){return console.log(o),null}};function H(i,s,o){let r=0,p=0;return i.forEach(([u,t])=>{r+=u;const j=(s-t)/(365*24*60*60*1e3);p+=u/r*j}),(((o/r)**(1/p)-1)*100).toFixed(1)}const W=({setIsNew:i,company:s,deals:o,userId:r})=>{var u;const p=M(),a=(u=m())==null?void 0:u.user;return e.jsx("div",{className:"pop",children:e.jsxs("div",{className:"pop-body col-md-10",children:[e.jsx("div",{className:"text-end",children:e.jsx(R,{onClick:()=>i(t=>!t),className:"cursor-pointer",size:30})}),e.jsx("div",{className:"",children:e.jsxs("table",{children:[e.jsx("thead",{className:"thead-dark",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col text-uppercase ",style:{width:"60px",aspectRatio:"1/1"},className:"border-0",children:" "}),e.jsx("th",{scope:"col text-uppercase ",children:" COMPANY NAME"}),e.jsx("th",{scope:"col text-uppercase ",children:"ASSET ClASS "}),e.jsx("th",{scope:"col text-uppercase ",children:" INVESTMENT DATE"}),e.jsx("th",{scope:"col text-uppercase ",children:" INVESTMENT"}),e.jsx("th",{scope:"col text-uppercase ",children:"NET PROFIT(LOSS)"}),e.jsx("th",{scope:"col text-uppercase ",children:"SECTOR"}),e.jsx("th",{scope:"col text-uppercase ",children:"NET MOIC"}),e.jsx("th",{scope:"col text-uppercase ",children:"NET IRR "}),e.jsx("th",{scope:"col text-uppercase ",children:"WEIGHT "}),e.jsx("th",{style:{width:"60px",aspectRatio:"1/1"},className:"border-0"})]})}),e.jsx("tbody",{children:o==null?void 0:o.map((t,j)=>{var S,N,n,f,x,h,d,c,l,E,F;return e.jsxs("tr",{className:"p-3 ",children:[e.jsx("td",{children:e.jsxs("div",{onClick:()=>p("about",{state:s==null?void 0:s._id}),className:" ms-3",style:{width:"50px",aspectRatio:"1/1"},children:["  ",e.jsx("img",{className:"w-100 h-100 rounded-circle",src:C+(s==null?void 0:s.profile)||(s==null?void 0:s.img),alt:""})]})}),e.jsx("td",{className:"text-capitalize",children:s==null?void 0:s.name}),e.jsx("td",{children:(S=s==null?void 0:s.dealSummary)==null?void 0:S.asset}),e.jsx("td",{children:t==null?void 0:t.investedDate}),e.jsxs("td",{children:[" ",w((t==null?void 0:t.investors)&&((n=(N=t==null?void 0:t.investors)==null?void 0:N.find(g=>g.investerId===(a==null?void 0:a._id)))==null?void 0:n.amount)||(t==null?void 0:t.investors)&&((x=(f=t==null?void 0:t.investors)==null?void 0:f.find(g=>g.investerId===r))==null?void 0:x.amount))]}),e.jsx(O,{deal:t,currentValuation:(h=s==null?void 0:s.dealSummary)==null?void 0:h.currentValuation,userId:r||(a==null?void 0:a._id),sector:(d=s==null?void 0:s.dealSummary)==null?void 0:d.sector}),e.jsx("td",{children:e.jsx(_,{initialInvestment:(t==null?void 0:t.investors)&&((l=(c=t==null?void 0:t.investors)==null?void 0:c.find(g=>g.investerId===(r||(a==null?void 0:a._id))))==null?void 0:l.amount),investmentDate:t==null?void 0:t.investedDate,currentValue:t==null?void 0:t.currentValue})}),e.jsxs("td",{children:[(t==null?void 0:t.investors)&&((F=(E=t==null?void 0:t.investors)==null?void 0:E.find(g=>g.investerId===r))==null?void 0:F.shareholding),"%"]})]},j)})})]})})]})})},_=({initialInvestment:i,investmentDate:s,currentValue:o})=>{const[r,p]=I.useState(0);return I.useEffect(()=>{p(b(parseInt(i||0),new Date(s),parseInt(o||0),new Date))},[i,s,o]),e.jsxs(e.Fragment,{children:[" ",r]})},X=({deals:i,sector:s,currentValuation:o,userId:r})=>{const[p,a]=I.useState(0),[u,t]=I.useState(0),[j,S]=I.useState(0),N=async()=>{const f=(await P(r)).reduce((x,h)=>{var c;const d=(c=h==null?void 0:h.investors)==null?void 0:c.find(l=>l.investerId===r);return x+parseInt((d==null?void 0:d.amount)||0)},0);S(f)};return I.useEffect(()=>{const n=async()=>{var h;let f=0,x=0;for(const d of i){const c=(h=d==null?void 0:d.investors)==null?void 0:h.find(l=>l.investerId===r);if(c){const l=parseFloat((c==null?void 0:c.amount)||0)+parseFloat((c==null?void 0:c.fees)||0),E=parseFloat((c==null?void 0:c.carried)||0),F=parseFloat((c==null?void 0:c.shareholding)||0),g=await D(l,F,o,d.currency,E/100),A=await T(l,F,o,d.currency,E/100);f+=g,x+=A}}a(f.toFixed(2)),t(x)};N().then(()=>n())},[o,r,i]),e.jsxs(e.Fragment,{children:[e.jsx("td",{children:w(p)}),e.jsx("td",{children:s}),e.jsx("td",{children:u})]})};export{W as D,X as N,H as c,G as p};

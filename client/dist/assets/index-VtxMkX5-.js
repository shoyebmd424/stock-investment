import{u as I,r,j as s}from"./index-BzgxH7_M.js";import{c as w,g as E,u as C}from"./dateTimeFormater-D7Rvvgct.js";import{n as F,a as D}from"./investorGrossTotal-D-hXK5B4.js";import{S as M}from"./index-DQlLYHdx.js";import{c as T}from"./calculateIrrSingleInvestment-Dz4nqlKD.js";import{g as O}from"./companyService-b3vlbPf8.js";import{g as R}from"./AuthService-DGn1PQ4G.js";import{M as A,a as k,b as z}from"./index-BAHlO6AQ.js";import"./iconBase-2GWgdyYW.js";const K=()=>{const c=I(),[e,p]=r.useState([]),[n,l]=r.useState("desc");r.useEffect(()=>{(async()=>{const a=await E(),o=await Promise.all(a.map(async i=>{const d=await f(i.companyId);return{...i,companyName:d==null?void 0:d.name,profile:d==null?void 0:d.profile}}));p(o)})()},[]);const f=async t=>await O(t),u=()=>{l(a=>a=="asc"?"desc":"asc");const t=[...e].sort((a,o)=>{var i,d;return n==="asc"?(i=a==null?void 0:a.companyName)==null?void 0:i.localeCompare(o==null?void 0:o.companyName):n==="desc"?(d=o==null?void 0:o.companyName)==null?void 0:d.localeCompare(a==null?void 0:a.companyName):0});p(t)};return s.jsx("div",{children:s.jsxs("table",{className:"ps-5",children:[s.jsx("thead",{className:"thead-dark",children:s.jsxs("tr",{children:[s.jsx("th",{scope:"col text-uppercase ",style:{width:"60px",aspectRatio:"1/1"},className:"border-0",children:" "}),s.jsxs("th",{scope:"col text-uppercase ",onClick:()=>u(),children:[" COMPANY ",n==="asc"?s.jsx(A,{size:30}):s.jsx(k,{size:30})]}),s.jsx("th",{scope:"col text-uppercase ",children:"Investor "}),s.jsx("th",{scope:"col text-uppercase ",children:" INVESTMENT DATE"}),s.jsx("th",{scope:"col text-uppercase ",children:" INVESTMENT"}),s.jsx("th",{scope:"col text-uppercase ",children:"NET PROFIT(LOSS)"}),s.jsx("th",{scope:"col text-uppercase ",children:"NET MOIC"}),s.jsx("th",{scope:"col text-uppercase ",children:"NET IRR "}),s.jsx("th",{scope:"col text-uppercase ",children:"Current Shareholding(%) "}),s.jsx("th",{style:{width:"60px",aspectRatio:"1/1"},className:"border-0"})]})}),s.jsx("tbody",{children:e==null?void 0:e.map((t,a)=>{var o;return(o=t==null?void 0:t.investors)==null?void 0:o.map((i,d)=>s.jsxs("tr",{className:"p-3 ",children:[s.jsx("td",{children:s.jsx("div",{onClick:()=>c("about",{state:t==null?void 0:t.companyId}),className:" ms-3",style:{width:"50px",aspectRatio:"1/1"},children:s.jsx("img",{className:"w-100 h-100 rounded-circle",src:M+(t==null?void 0:t.profile)||(t==null?void 0:t.img),alt:""})})}),s.jsx("td",{className:"text-capitalize",children:t==null?void 0:t.companyName}),s.jsx(B,{deal:t,investor:i,investDate:t==null?void 0:t.investedDate,currentValuation:t==null?void 0:t.currentValue})]},a))})})]})})},B=({deal:c,investor:e,investDate:p,currentValuation:n})=>{const[l,f]=r.useState(0),[u,t]=r.useState(0),[a,o]=r.useState(e==null?void 0:e.shareholding),[i,d]=r.useState(!1);r.useEffect(()=>{(async()=>{const x=parseFloat((e==null?void 0:e.amount)||0)+parseFloat((e==null?void 0:e.fees)||0),m=parseFloat((e==null?void 0:e.carried)||0),y=parseFloat((e==null?void 0:e.shareholding)||0),N=await F(x,y,n,c.currency,m/100),S=await D(x,y,n,c.currency,m/100);f(N==null?void 0:N.toFixed(2)),t(S)})()},[c,e,p,n]);const h=r.useRef();r.useEffect(()=>{const j=x=>{h!=null&&h.current&&!(h!=null&&h.current.contains(x.target))&&d(!1)};return document.addEventListener("mousedown",j),()=>{document.removeEventListener("mousedown",j)}},[]);const g=async j=>{const{value:x}=j.target;c.investors.find(m=>(m==null?void 0:m.investerId)===(e==null?void 0:e.investerId)&&(m==null?void 0:m.profit)===(e==null?void 0:e.profit)).shareholding=parseFloat(x||0),o(x),await C(c==null?void 0:c._id,c)};return s.jsxs(s.Fragment,{children:[s.jsx("td",{children:s.jsx(P,{id:e==null?void 0:e.investerId})}),s.jsx("td",{children:p}),s.jsxs("td",{children:[" ",w(e==null?void 0:e.invest,c==null?void 0:c.currency)]}),s.jsx("td",{children:l}),s.jsxs("td",{children:[" ",u]}),s.jsx("td",{children:s.jsx(L,{initialInvestment:e==null?void 0:e.amount,investmentDate:p,currentValue:n})}),s.jsxs("td",{style:{width:"60px",aspectRatio:"1/1"},children:[" ",s.jsxs("div",{className:"d-flex field ",ref:h,children:[" ",i?s.jsx("input",{type:"text",className:"input-field py-2 me-3",value:a,onChange:g}):s.jsx(s.Fragment,{children:s.jsxs("div",{className:"d-flex gap-3",children:[s.jsxs("span",{children:[a,"%"]})," ",s.jsx(z,{className:"text-danger",onClick:()=>d(!0),style:{cursor:"pointer"},size:20}),"  "]})})]})]})]})},P=({id:c})=>{var n,l;const[e,p]=r.useState(null);return r.useEffect(()=>{c&&(async()=>{const u=await R(c);p(u)})()},[c]),console.log(e),s.jsxs(s.Fragment,{children:[" ",(n=e==null?void 0:e.personal)==null?void 0:n.firstName," ",(l=e==null?void 0:e.personal)==null?void 0:l.lastName]})},L=({initialInvestment:c,investmentDate:e,currentValue:p})=>{const[n,l]=r.useState(0);return r.useEffect(()=>{l(T(parseInt(c||0),new Date(e),parseInt(p||0),new Date))},[c,e,p]),s.jsxs(s.Fragment,{children:[" ",n]})};export{K as default};
